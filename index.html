<!doctype html>
<html>
  <head>
    <h3>VR Fingerprint Research</h3>
  </head>
  <body>
    <script>
      const params = new URLSearchParams(window.location.search);
      const prolific_id = params.get("PROLIFIC_PID");
      const study_id = params.get("STUDY_ID");
      const session_id = params.get("SESSION_ID");

      function hashString(str) {
        let has = 5381;
        for (let i = 0; i < str.length; i++) {
          hash = (hash << 5) + hash + str.charCodeAt(i);
          hash = hash & 0xffffffff;
        }
        return Math.abs(hash);
      }

      function generateCode(prolific_id) {
        const hash = hashString(prolific_id);
        const code = (hash % 900000) + 100000;
        return code;
      }

      const output = document.getElementById("result");
      if (prolific_id) {
        const code = generateCode(prolific_id);
        output.innerText = `Prolific PID = ${prolific_id}. Your verification code = ${code}.`;
      } else {
        output.innerText = `No Prolific PID found in URL.`;
      }
    </script>
    <p>
      You are expected to have one of Meta Quest 2, Meta Quest 3, or Meta Quest
      3s. Any other types of VR headsets are not supported.
    </p>
    <p>
      Each device is allowed to participate only once. Multiple attempts will
      result in rejection.
    </p>

    <h3>Preparation</h3>
    <ol>
      <li>Connect your VR headset to Wi-Fi.</li>
      <!--<li>Please make sure your device's volume is set to the maximum.</li>-->
      <li>
        Set the Display-off time to 15 minutes. (Library -> Settings -> General
        -> Power -> Display off)
      </li>
      <li>
        Enable the Developer Mode of your headset using the Meta Horizon app on
        your smartphone (Meta Horizon app -> Device (Upper left corner) ->
        Headset Settings -> Developer Mode)
      </li>
      <li>
        Download the APK:
        <a
          href="https://drive.google.com/file/d/1vSzEkVdpBxtEpqfcOowRSe2TA4hUHxCd/view?usp=sharing"
          >VRSensorLog.apk</a
        >
      </li>
      <li>
        In the Meta Horizon Store, search and install the Mobile VR Station.
      </li>
      <li>
        Open Mobile VR Station -> Allow Permissions -> Click continue at the
        bottom -> Configuration Wizard -> Show All Options -> Configure Manage
        All Files -> Open Files All -> Locate VRSensorLog.apk -> Settings ->
        Allow from this source -> Install
      </li>
      <li>
        Open “AndroidSensorLog” from the Mobile VR Station on your headset.
      </li>
    </ol>

    <p>There are 3 assignments for you to finish:</p>
    <strong>Assignment 1: Stable on the Table</strong>
    <ol>
      <li>
        Please make sure your device is on a separate table without any laptops,
        speakers, or anything else that could cause vibrations.
      </li>

      <li>Put on your headset.</li>
      <li>
        Press <strong>Start</strong>, take off your headset, and put it on the
        table.
      </li>
      <li>
        Wait for at least 5 minutes, put on your headset, select
        <strong>Stop and Upload</strong>, and wait for
        <code>Upload Successful.</code> to show at the bottom of the screen.
      </li>
    </ol>
    <p>
      <em
        >Failure to upload a valid data file collected for at least 5 minutes
        will result in rejection.</em
      >
    </p>

    <strong>Assignment 2: Sitting Still</strong>
    <ol>
      <li>Put on your headset.</li>
      <li>
        Press <strong>Next</strong> and SIT STILL wherever you feel confortable.
        Try to stay still as much as you can.
      </li>
      <li>
        Wait for at least 5 minutes, select <strong>Stop and Upload</strong> and
        wait for <code>Upload Successful.</code> to show at the bottom of the
        screen.
      </li>
    </ol>
    <p>
      <em
        >Failure to upload a valid data file collected for at least 5 minutes
        will result in rejection.</em
      >
    </p>

    <strong>Assignment 3: Standing Still</strong>
    <ol>
      <li>Put on your headset.</li>
      <li>
        Press <strong>Next</strong> and STAND STILL. Try to stay still as much
        as you can.
      </li>
      <li>
        Wait for at least 5 minutes, select <strong>Stop and Upload</strong> and
        wait for <code>Upload Successful.</code> to show at the bottom of the
        screen.
      </li>
    </ol>
    <p>
      <em
        >Failure to upload a valid data file collected for at least 5 minutes
        will result in rejection.</em
      >
    </p>

    <p>
      When you finish all the tasks, a 6-digit code is generated at the bottom
      of the screen. Please enter this code in the corresponding section on the
      website. Failure to enter a valid code will result in rejection.
    </p>
    <p>
      Before submitting the assignments, please enter your email in the VR
      application. Failure to enter a valid email address will result in
      rejection.
    </p>
    <!---
    <strong>Please enter your email address and your device type here below.</strong>
    <div>
        <p><strong>Email address:</strong></p>
        <crowd-input name="email" default-value=${task.input.email} placeholder="e.g. example@email.com" type="email" required></crowd-input>
    </div>

    <div>
        <p><strong>Device Type:</strong></p>
        <crowd-input name="deviceType" default-value=${task.input.deviceType} placeholder="Meta Quest 2, Meta Quest 3, or Meta Quest 3s" required></crowd-input>
    </div>
    --->
    <p>
      <strong
        >Thanks for your participation. Please click the submit button
        below.</strong
      >
    </p>
    <button
      onclick="location.href='https://yourusername.github.io/yourrepo/target.html'"
    >
      Go to Target Page
    </button>
    <p>
      If you have any questions or suggestions, please contact
      <a href="mailto:yi.qu@temple.edu">yi.qu@temple.edu</a>. Thanks.
    </p>
  </body>
</html>
